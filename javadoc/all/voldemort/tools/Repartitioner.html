<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_27) on Tue Sep 23 17:25:05 PDT 2014 -->
<TITLE>
Repartitioner (Voldemort)
</TITLE>

<META NAME="date" CONTENT="2014-09-23">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="Repartitioner (Voldemort)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/Repartitioner.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../voldemort/tools/RebalancePlanCLI.html" title="class in voldemort.tools"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../voldemort/tools/RepartitionerCLI.html" title="class in voldemort.tools"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html?voldemort/tools/Repartitioner.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="Repartitioner.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
voldemort.tools</FONT>
<BR>
Class Repartitioner</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../resources/inherit.gif" ALT="extended by "><B>voldemort.tools.Repartitioner</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>Repartitioner</B><DT>extends java.lang.Object</DL>
</PRE>

<P>
RepartitionUtils provides functions that balance the distribution of
 partitions across a cluster.
<P>

<P>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../voldemort/tools/Repartitioner.html#DEFAULT_GREEDY_MAX_PARTITIONS_PER_NODE">DEFAULT_GREEDY_MAX_PARTITIONS_PER_NODE</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default (max) number of partition IDs per node to consider, if greedy
 swaps are enabled.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../voldemort/tools/Repartitioner.html#DEFAULT_GREEDY_MAX_PARTITIONS_PER_ZONE">DEFAULT_GREEDY_MAX_PARTITIONS_PER_ZONE</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default (max) number of partition IDs from all the other nodes in the
 cluster to consider, if greedy swaps are enabled.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../voldemort/tools/Repartitioner.html#DEFAULT_GREEDY_SWAP_ATTEMPTS">DEFAULT_GREEDY_SWAP_ATTEMPTS</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default number of greedy partition ID swaps to perform, if greedy swaps
 are enabled.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;java.util.List&lt;java.lang.Integer&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../voldemort/tools/Repartitioner.html#DEFAULT_GREEDY_SWAP_ZONE_IDS">DEFAULT_GREEDY_SWAP_ZONE_IDS</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default setting for which zone IDs to run greedy swap algorithm.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../voldemort/tools/Repartitioner.html#DEFAULT_MAX_CONTIGUOUS_PARTITIONS">DEFAULT_MAX_CONTIGUOUS_PARTITIONS</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default limit on length of contiguous partition ID run within a zone.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../voldemort/tools/Repartitioner.html#DEFAULT_RANDOM_SWAP_ATTEMPTS">DEFAULT_RANDOM_SWAP_ATTEMPTS</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default number of random partition ID swaps to attempt, if random swaps
 are enabled.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../voldemort/tools/Repartitioner.html#DEFAULT_RANDOM_SWAP_SUCCESSES">DEFAULT_RANDOM_SWAP_SUCCESSES</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default number of successful random swaps (i.e., the random swap improves
 balance) after which reparitioning stops, if random swaps are enabled.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;java.util.List&lt;java.lang.Integer&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../voldemort/tools/Repartitioner.html#DEFAULT_RANDOM_SWAP_ZONE_IDS">DEFAULT_RANDOM_SWAP_ZONE_IDS</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default setting for which zone IDs to run random swap algorithm.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../voldemort/tools/Repartitioner.html#DEFAULT_REPARTITION_ATTEMPTS">DEFAULT_REPARTITION_ATTEMPTS</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Recommended (default) number of times to attempt repartitioning.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../voldemort/tools/Repartitioner.html#Repartitioner()">Repartitioner</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../voldemort/tools/Repartitioner.html#balanceContiguousPartitionsPerZone(voldemort.cluster.Cluster, int)">balanceContiguousPartitionsPerZone</A></B>(<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A>&nbsp;nextCandidateCluster,
                                   int&nbsp;maxContiguousPartitionsPerZone)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ensures that no more than maxContiguousPartitionsPerZone partitions are
 contiguous within a single zone.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../voldemort/tools/Repartitioner.html#balancePrimaryPartitions(voldemort.cluster.Cluster, boolean)">balancePrimaryPartitions</A></B>(<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A>&nbsp;nextCandidateCluster,
                         boolean&nbsp;balanceZones)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This method balances primary partitions among nodes within a zone, and
 optionally primary partitions among zones.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;java.util.HashMap&lt;java.lang.Integer,java.util.List&lt;java.lang.Integer&gt;&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../voldemort/tools/Repartitioner.html#getBalancedNumberOfPrimaryPartitionsPerNode(voldemort.cluster.Cluster, java.util.Map)">getBalancedNumberOfPrimaryPartitionsPerNode</A></B>(<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A>&nbsp;nextCandidateCluster,
                                            java.util.Map&lt;java.lang.Integer,java.lang.Integer&gt;&nbsp;targetPartitionsPerZone)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Determines how many primary partitions each node within each zone should
 have.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../../voldemort/utils/Pair.html" title="class in voldemort.utils">Pair</A>&lt;java.util.HashMap&lt;<A HREF="../../voldemort/cluster/Node.html" title="class in voldemort.cluster">Node</A>,java.lang.Integer&gt;,java.util.HashMap&lt;<A HREF="../../voldemort/cluster/Node.html" title="class in voldemort.cluster">Node</A>,java.lang.Integer&gt;&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../voldemort/tools/Repartitioner.html#getDonorsAndStealersForBalance(voldemort.cluster.Cluster, java.util.Map)">getDonorsAndStealersForBalance</A></B>(<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A>&nbsp;nextCandidateCluster,
                               java.util.Map&lt;java.lang.Integer,java.util.List&lt;java.lang.Integer&gt;&gt;&nbsp;numPartitionsPerNodePerZone)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Assign target number of partitions per node to specific node IDs.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../voldemort/tools/Repartitioner.html#greedyShufflePartitions(voldemort.cluster.Cluster, int, int, int, java.util.List, java.util.List)">greedyShufflePartitions</A></B>(<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A>&nbsp;nextCandidateCluster,
                        int&nbsp;greedyAttempts,
                        int&nbsp;greedySwapMaxPartitionsPerNode,
                        int&nbsp;greedySwapMaxPartitionsPerZone,
                        java.util.List&lt;java.lang.Integer&gt;&nbsp;greedySwapZoneIds,
                        java.util.List&lt;<A HREF="../../voldemort/store/StoreDefinition.html" title="class in voldemort.store">StoreDefinition</A>&gt;&nbsp;storeDefs)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Within a single zone, tries swapping some minimum number of random
 partitions per node with some minimum number of random partitions from
 other nodes within the zone.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../voldemort/tools/Repartitioner.html#randomShufflePartitions(voldemort.cluster.Cluster, int, int, java.util.List, java.util.List)">randomShufflePartitions</A></B>(<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A>&nbsp;nextCandidateCluster,
                        int&nbsp;randomSwapAttempts,
                        int&nbsp;randomSwapSuccesses,
                        java.util.List&lt;java.lang.Integer&gt;&nbsp;randomSwapZoneIds,
                        java.util.List&lt;<A HREF="../../voldemort/store/StoreDefinition.html" title="class in voldemort.store">StoreDefinition</A>&gt;&nbsp;storeDefs)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Randomly shuffle partitions between nodes within every zone.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../voldemort/tools/Repartitioner.html#repartition(voldemort.cluster.Cluster, java.util.List, voldemort.cluster.Cluster, java.util.List, java.lang.String, int, boolean, boolean, boolean, int, int, java.util.List, boolean, int, int, int, java.util.List, int)">repartition</A></B>(<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A>&nbsp;currentCluster,
            java.util.List&lt;<A HREF="../../voldemort/store/StoreDefinition.html" title="class in voldemort.store">StoreDefinition</A>&gt;&nbsp;currentStoreDefs,
            <A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A>&nbsp;interimCluster,
            java.util.List&lt;<A HREF="../../voldemort/store/StoreDefinition.html" title="class in voldemort.store">StoreDefinition</A>&gt;&nbsp;finalStoreDefs,
            java.lang.String&nbsp;outputDir,
            int&nbsp;attempts,
            boolean&nbsp;disableNodeBalancing,
            boolean&nbsp;disableZoneBalancing,
            boolean&nbsp;enableRandomSwaps,
            int&nbsp;randomSwapAttempts,
            int&nbsp;randomSwapSuccesses,
            java.util.List&lt;java.lang.Integer&gt;&nbsp;randomSwapZoneIds,
            boolean&nbsp;enableGreedySwaps,
            int&nbsp;greedySwapAttempts,
            int&nbsp;greedySwapMaxPartitionsPerNode,
            int&nbsp;greedySwapMaxPartitionsPerZone,
            java.util.List&lt;java.lang.Integer&gt;&nbsp;greedySwapZoneIds,
            int&nbsp;maxContiguousPartitionsPerZone)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Runs a number of distinct algorithms over the specified clusters/store
 defs to better balance partition IDs over nodes such that all nodes have
 similar iops and capacity usage.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../voldemort/tools/Repartitioner.html#repeatedlyBalanceContiguousPartitionsPerZone(voldemort.cluster.Cluster, int)">repeatedlyBalanceContiguousPartitionsPerZone</A></B>(<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A>&nbsp;nextCandidateCluster,
                                             int&nbsp;maxContiguousPartitionsPerZone)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Loops over cluster and repeatedly tries to break up contiguous runs of
 partitions.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../voldemort/tools/Repartitioner.html#swapGreedyRandomPartitions(voldemort.cluster.Cluster, java.util.List, int, int, java.util.List)">swapGreedyRandomPartitions</A></B>(<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A>&nbsp;nextCandidateCluster,
                           java.util.List&lt;java.lang.Integer&gt;&nbsp;nodeIds,
                           int&nbsp;greedySwapMaxPartitionsPerNode,
                           int&nbsp;greedySwapMaxPartitionsPerZone,
                           java.util.List&lt;<A HREF="../../voldemort/store/StoreDefinition.html" title="class in voldemort.store">StoreDefinition</A>&gt;&nbsp;storeDefs)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For each node in specified zones, tries swapping some minimum number of
 random partitions per node with some minimum number of random partitions
 from other specified nodes.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../voldemort/tools/Repartitioner.html#swapPartitions(voldemort.cluster.Cluster, int, int, int, int)">swapPartitions</A></B>(<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A>&nbsp;nextCandidateCluster,
               int&nbsp;nodeIdA,
               int&nbsp;partitionIdA,
               int&nbsp;nodeIdB,
               int&nbsp;partitionIdB)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Swaps two specified partitions.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../voldemort/tools/Repartitioner.html#swapRandomPartitionsAmongNodes(voldemort.cluster.Cluster, java.util.List)">swapRandomPartitionsAmongNodes</A></B>(<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A>&nbsp;nextCandidateCluster,
                               java.util.List&lt;java.lang.Integer&gt;&nbsp;nodeIds)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Shuffles partitions among all nodes specified.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../voldemort/tools/Repartitioner.html#swapRandomPartitionsWithinZone(voldemort.cluster.Cluster, int)">swapRandomPartitionsWithinZone</A></B>(<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A>&nbsp;nextCandidateCluster,
                               int&nbsp;zoneId)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Within a single zone, swaps one random partition on one random node with
 another random partition on different random node.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="DEFAULT_REPARTITION_ATTEMPTS"><!-- --></A><H3>
DEFAULT_REPARTITION_ATTEMPTS</H3>
<PRE>
public static final int <B>DEFAULT_REPARTITION_ATTEMPTS</B></PRE>
<DL>
<DD>Recommended (default) number of times to attempt repartitioning.
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../constant-values.html#voldemort.tools.Repartitioner.DEFAULT_REPARTITION_ATTEMPTS">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="DEFAULT_RANDOM_SWAP_ATTEMPTS"><!-- --></A><H3>
DEFAULT_RANDOM_SWAP_ATTEMPTS</H3>
<PRE>
public static final int <B>DEFAULT_RANDOM_SWAP_ATTEMPTS</B></PRE>
<DL>
<DD>Default number of random partition ID swaps to attempt, if random swaps
 are enabled.
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../constant-values.html#voldemort.tools.Repartitioner.DEFAULT_RANDOM_SWAP_ATTEMPTS">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="DEFAULT_RANDOM_SWAP_SUCCESSES"><!-- --></A><H3>
DEFAULT_RANDOM_SWAP_SUCCESSES</H3>
<PRE>
public static final int <B>DEFAULT_RANDOM_SWAP_SUCCESSES</B></PRE>
<DL>
<DD>Default number of successful random swaps (i.e., the random swap improves
 balance) after which reparitioning stops, if random swaps are enabled.
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../constant-values.html#voldemort.tools.Repartitioner.DEFAULT_RANDOM_SWAP_SUCCESSES">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="DEFAULT_RANDOM_SWAP_ZONE_IDS"><!-- --></A><H3>
DEFAULT_RANDOM_SWAP_ZONE_IDS</H3>
<PRE>
public static final java.util.List&lt;java.lang.Integer&gt; <B>DEFAULT_RANDOM_SWAP_ZONE_IDS</B></PRE>
<DL>
<DD>Default setting for which zone IDs to run random swap algorithm. Empty
 implies all zones will be considered.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="DEFAULT_GREEDY_SWAP_ATTEMPTS"><!-- --></A><H3>
DEFAULT_GREEDY_SWAP_ATTEMPTS</H3>
<PRE>
public static final int <B>DEFAULT_GREEDY_SWAP_ATTEMPTS</B></PRE>
<DL>
<DD>Default number of greedy partition ID swaps to perform, if greedy swaps
 are enabled. Each greedy partition ID swaps considers (some number of
 partitions per node) X (some number of partitions from rest of cluster)
 and selects the best such swap.
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../constant-values.html#voldemort.tools.Repartitioner.DEFAULT_GREEDY_SWAP_ATTEMPTS">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="DEFAULT_GREEDY_SWAP_ZONE_IDS"><!-- --></A><H3>
DEFAULT_GREEDY_SWAP_ZONE_IDS</H3>
<PRE>
public static final java.util.List&lt;java.lang.Integer&gt; <B>DEFAULT_GREEDY_SWAP_ZONE_IDS</B></PRE>
<DL>
<DD>Default setting for which zone IDs to run greedy swap algorithm. Empty
 implies all zones will be considered.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="DEFAULT_GREEDY_MAX_PARTITIONS_PER_NODE"><!-- --></A><H3>
DEFAULT_GREEDY_MAX_PARTITIONS_PER_NODE</H3>
<PRE>
public static final int <B>DEFAULT_GREEDY_MAX_PARTITIONS_PER_NODE</B></PRE>
<DL>
<DD>Default (max) number of partition IDs per node to consider, if greedy
 swaps are enabled.
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../constant-values.html#voldemort.tools.Repartitioner.DEFAULT_GREEDY_MAX_PARTITIONS_PER_NODE">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="DEFAULT_GREEDY_MAX_PARTITIONS_PER_ZONE"><!-- --></A><H3>
DEFAULT_GREEDY_MAX_PARTITIONS_PER_ZONE</H3>
<PRE>
public static final int <B>DEFAULT_GREEDY_MAX_PARTITIONS_PER_ZONE</B></PRE>
<DL>
<DD>Default (max) number of partition IDs from all the other nodes in the
 cluster to consider, if greedy swaps are enabled.
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../constant-values.html#voldemort.tools.Repartitioner.DEFAULT_GREEDY_MAX_PARTITIONS_PER_ZONE">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="DEFAULT_MAX_CONTIGUOUS_PARTITIONS"><!-- --></A><H3>
DEFAULT_MAX_CONTIGUOUS_PARTITIONS</H3>
<PRE>
public static final int <B>DEFAULT_MAX_CONTIGUOUS_PARTITIONS</B></PRE>
<DL>
<DD>Default limit on length of contiguous partition ID run within a zone. 0
 implies no limit on such runs.
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../constant-values.html#voldemort.tools.Repartitioner.DEFAULT_MAX_CONTIGUOUS_PARTITIONS">Constant Field Values</A></DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="Repartitioner()"><!-- --></A><H3>
Repartitioner</H3>
<PRE>
public <B>Repartitioner</B>()</PRE>
<DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="repartition(voldemort.cluster.Cluster, java.util.List, voldemort.cluster.Cluster, java.util.List, java.lang.String, int, boolean, boolean, boolean, int, int, java.util.List, boolean, int, int, int, java.util.List, int)"><!-- --></A><H3>
repartition</H3>
<PRE>
public static <A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A> <B>repartition</B>(<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A>&nbsp;currentCluster,
                                  java.util.List&lt;<A HREF="../../voldemort/store/StoreDefinition.html" title="class in voldemort.store">StoreDefinition</A>&gt;&nbsp;currentStoreDefs,
                                  <A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A>&nbsp;interimCluster,
                                  java.util.List&lt;<A HREF="../../voldemort/store/StoreDefinition.html" title="class in voldemort.store">StoreDefinition</A>&gt;&nbsp;finalStoreDefs,
                                  java.lang.String&nbsp;outputDir,
                                  int&nbsp;attempts,
                                  boolean&nbsp;disableNodeBalancing,
                                  boolean&nbsp;disableZoneBalancing,
                                  boolean&nbsp;enableRandomSwaps,
                                  int&nbsp;randomSwapAttempts,
                                  int&nbsp;randomSwapSuccesses,
                                  java.util.List&lt;java.lang.Integer&gt;&nbsp;randomSwapZoneIds,
                                  boolean&nbsp;enableGreedySwaps,
                                  int&nbsp;greedySwapAttempts,
                                  int&nbsp;greedySwapMaxPartitionsPerNode,
                                  int&nbsp;greedySwapMaxPartitionsPerZone,
                                  java.util.List&lt;java.lang.Integer&gt;&nbsp;greedySwapZoneIds,
                                  int&nbsp;maxContiguousPartitionsPerZone)</PRE>
<DL>
<DD>Runs a number of distinct algorithms over the specified clusters/store
 defs to better balance partition IDs over nodes such that all nodes have
 similar iops and capacity usage.
 
 The algorithms (in order):
 <ul>
 <li>Get rid of contiguous runs of partition IDs within a zone. Such runs
 make balancing load overall more difficult.
 <li>Balance partition IDs among zones and/or among nodes within zones.
 <li>Randomly swap partition IDs among nodes to improve overall balance.
 (Any swap that improves balance is accepted.)
 <li>Greedily swap partition IDs among nodes to improve overall balance.
 (Some number of swaps are considered and the best of which is accepted.)
 </ul>
 
 This method is used for three key use cases:
 <ul>
 <li>Shuffling : Distribute partition IDs better for an existing cluster.
 <li>Cluster expansion : Distribute partition IDs to take advantage of new
 nodes (added to some of the zones).
 <li>Zone expansion : Distribute partition IDs into a new zone.
 </ul>
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>currentCluster</CODE> - current cluster<DD><CODE>currentStoreDefs</CODE> - current store defs<DD><CODE>interimCluster</CODE> - interim cluster; needed for cluster or zone
        expansion, otherwise pass in same as currentCluster.<DD><CODE>finalStoreDefs</CODE> - final store defs; needed for zone expansion,
        otherwise pass in same as currentStores.<DD><CODE>outputDir</CODE> - Directory in which to dump cluster xml and analysis
        files.<DD><CODE>attempts</CODE> - Number of distinct repartitionings to attempt, the best
        of which is returned.<DD><CODE>disableNodeBalancing</CODE> - Disables the core algorithm that balances
        primaries among nodes within each zone.<DD><CODE>disableZoneBalancing</CODE> - For the core algorithm that balances
        primaries among nodes in each zone, disable balancing primaries
        among zones.<DD><CODE>enableRandomSwaps</CODE> - Enables random swap optimization.<DD><CODE>randomSwapAttempts</CODE> - <DD><CODE>randomSwapSuccesses</CODE> - <DD><CODE>randomSwapZoneIds</CODE> - <DD><CODE>enableGreedySwaps</CODE> - Enables greedy swap optimization.<DD><CODE>greedySwapAttempts</CODE> - <DD><CODE>greedySwapMaxPartitionsPerNode</CODE> - <DD><CODE>greedySwapMaxPartitionsPerZone</CODE> - <DD><CODE>greedySwapZoneIds</CODE> - <DD><CODE>maxContiguousPartitionsPerZone</CODE> - 
<DT><B>Returns:</B><DD>"final cluster" that has had all specified balancing algorithms
         run against it. The number of zones and number of nodes will
         match that of the specified "interim cluster".</DL>
</DD>
</DL>
<HR>

<A NAME="getBalancedNumberOfPrimaryPartitionsPerNode(voldemort.cluster.Cluster, java.util.Map)"><!-- --></A><H3>
getBalancedNumberOfPrimaryPartitionsPerNode</H3>
<PRE>
public static java.util.HashMap&lt;java.lang.Integer,java.util.List&lt;java.lang.Integer&gt;&gt; <B>getBalancedNumberOfPrimaryPartitionsPerNode</B>(<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A>&nbsp;nextCandidateCluster,
                                                                                                                                 java.util.Map&lt;java.lang.Integer,java.lang.Integer&gt;&nbsp;targetPartitionsPerZone)</PRE>
<DL>
<DD>Determines how many primary partitions each node within each zone should
 have. The list of integers returned per zone is the same length as the
 number of nodes in that zone.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>nextCandidateCluster</CODE> - <DD><CODE>targetPartitionsPerZone</CODE> - 
<DT><B>Returns:</B><DD>A map of zoneId to list of target number of partitions per node
         within zone.</DL>
</DD>
</DL>
<HR>

<A NAME="getDonorsAndStealersForBalance(voldemort.cluster.Cluster, java.util.Map)"><!-- --></A><H3>
getDonorsAndStealersForBalance</H3>
<PRE>
public static <A HREF="../../voldemort/utils/Pair.html" title="class in voldemort.utils">Pair</A>&lt;java.util.HashMap&lt;<A HREF="../../voldemort/cluster/Node.html" title="class in voldemort.cluster">Node</A>,java.lang.Integer&gt;,java.util.HashMap&lt;<A HREF="../../voldemort/cluster/Node.html" title="class in voldemort.cluster">Node</A>,java.lang.Integer&gt;&gt; <B>getDonorsAndStealersForBalance</B>(<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A>&nbsp;nextCandidateCluster,
                                                                                                                                       java.util.Map&lt;java.lang.Integer,java.util.List&lt;java.lang.Integer&gt;&gt;&nbsp;numPartitionsPerNodePerZone)</PRE>
<DL>
<DD>Assign target number of partitions per node to specific node IDs. Then,
 separates Nodes into donorNodes and stealerNodes based on whether the
 node needs to donate or steal primary partitions.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>nextCandidateCluster</CODE> - <DD><CODE>numPartitionsPerNodePerZone</CODE> - 
<DT><B>Returns:</B><DD>a Pair. First element is donorNodes, second element is
         stealerNodes. Each element in the pair is a HashMap of Node to
         Integer where the integer value is the number of partitions to
         store.</DL>
</DD>
</DL>
<HR>

<A NAME="balancePrimaryPartitions(voldemort.cluster.Cluster, boolean)"><!-- --></A><H3>
balancePrimaryPartitions</H3>
<PRE>
public static <A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A> <B>balancePrimaryPartitions</B>(<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A>&nbsp;nextCandidateCluster,
                                               boolean&nbsp;balanceZones)</PRE>
<DL>
<DD>This method balances primary partitions among nodes within a zone, and
 optionally primary partitions among zones. The balancing is done at the
 level of partitionIds. Such partition Id movement may, or may not, result
 in data movement during a rebalancing. See RebalancePlan for the object
 responsible for determining which partition-stores move where for a
 specific repartitioning.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>nextCandidateCluster</CODE> - <DD><CODE>balanceZones</CODE> - indicates whether or not number of primary partitions
        per zone should be balanced.
<DT><B>Returns:</B><DD>updated cluster</DL>
</DD>
</DL>
<HR>

<A NAME="repeatedlyBalanceContiguousPartitionsPerZone(voldemort.cluster.Cluster, int)"><!-- --></A><H3>
repeatedlyBalanceContiguousPartitionsPerZone</H3>
<PRE>
public static <A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A> <B>repeatedlyBalanceContiguousPartitionsPerZone</B>(<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A>&nbsp;nextCandidateCluster,
                                                                   int&nbsp;maxContiguousPartitionsPerZone)</PRE>
<DL>
<DD>Loops over cluster and repeatedly tries to break up contiguous runs of
 partitions. After each phase of breaking up contiguous partitions, random
 partitions are selected to move between zones to balance the number of
 partitions in each zone. The second phase may re-introduce contiguous
 partition runs in another zone. Therefore, this overall process is
 repeated multiple times.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>nextCandidateCluster</CODE> - <DD><CODE>maxContiguousPartitionsPerZone</CODE> - See RebalanceCLI.
<DT><B>Returns:</B><DD>updated cluster</DL>
</DD>
</DL>
<HR>

<A NAME="balanceContiguousPartitionsPerZone(voldemort.cluster.Cluster, int)"><!-- --></A><H3>
balanceContiguousPartitionsPerZone</H3>
<PRE>
public static <A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A> <B>balanceContiguousPartitionsPerZone</B>(<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A>&nbsp;nextCandidateCluster,
                                                         int&nbsp;maxContiguousPartitionsPerZone)</PRE>
<DL>
<DD>Ensures that no more than maxContiguousPartitionsPerZone partitions are
 contiguous within a single zone.
 
 Moves the necessary partitions to break up contiguous runs from each zone
 to some other random zone/node. There is some chance that such random
 moves could result in contiguous partitions in other zones.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>nextCandidateCluster</CODE> - cluster metadata<DD><CODE>maxContiguousPartitionsPerZone</CODE> - See RebalanceCLI.
<DT><B>Returns:</B><DD>Return updated cluster metadata.</DL>
</DD>
</DL>
<HR>

<A NAME="swapPartitions(voldemort.cluster.Cluster, int, int, int, int)"><!-- --></A><H3>
swapPartitions</H3>
<PRE>
public static <A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A> <B>swapPartitions</B>(<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A>&nbsp;nextCandidateCluster,
                                     int&nbsp;nodeIdA,
                                     int&nbsp;partitionIdA,
                                     int&nbsp;nodeIdB,
                                     int&nbsp;partitionIdB)</PRE>
<DL>
<DD>Swaps two specified partitions.
 
 Pair-wase partition swapping may be more prone to local minima than
 larger perturbations. Could consider "swapping" a list of
 <nodeId/partitionId>. This would allow a few nodes to be identified
 (random # btw 2-5?) and then "swapped" (shuffled? rotated?).
<P>
<DD><DL>

<DT><B>Returns:</B><DD>modified cluster metadata.</DL>
</DD>
</DL>
<HR>

<A NAME="swapRandomPartitionsWithinZone(voldemort.cluster.Cluster, int)"><!-- --></A><H3>
swapRandomPartitionsWithinZone</H3>
<PRE>
public static <A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A> <B>swapRandomPartitionsWithinZone</B>(<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A>&nbsp;nextCandidateCluster,
                                                     int&nbsp;zoneId)</PRE>
<DL>
<DD>Within a single zone, swaps one random partition on one random node with
 another random partition on different random node.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>nextCandidateCluster</CODE> - <DD><CODE>zoneId</CODE> - Zone ID within which to shuffle partitions
<DT><B>Returns:</B><DD>updated cluster</DL>
</DD>
</DL>
<HR>

<A NAME="swapRandomPartitionsAmongNodes(voldemort.cluster.Cluster, java.util.List)"><!-- --></A><H3>
swapRandomPartitionsAmongNodes</H3>
<PRE>
public static <A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A> <B>swapRandomPartitionsAmongNodes</B>(<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A>&nbsp;nextCandidateCluster,
                                                     java.util.List&lt;java.lang.Integer&gt;&nbsp;nodeIds)</PRE>
<DL>
<DD>Shuffles partitions among all nodes specified.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>nextCandidateCluster</CODE> - <DD><CODE>nodeIds</CODE> - 
<DT><B>Returns:</B><DD>shuffled cluster</DL>
</DD>
</DL>
<HR>

<A NAME="randomShufflePartitions(voldemort.cluster.Cluster, int, int, java.util.List, java.util.List)"><!-- --></A><H3>
randomShufflePartitions</H3>
<PRE>
public static <A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A> <B>randomShufflePartitions</B>(<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A>&nbsp;nextCandidateCluster,
                                              int&nbsp;randomSwapAttempts,
                                              int&nbsp;randomSwapSuccesses,
                                              java.util.List&lt;java.lang.Integer&gt;&nbsp;randomSwapZoneIds,
                                              java.util.List&lt;<A HREF="../../voldemort/store/StoreDefinition.html" title="class in voldemort.store">StoreDefinition</A>&gt;&nbsp;storeDefs)</PRE>
<DL>
<DD>Randomly shuffle partitions between nodes within every zone.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>nextCandidateCluster</CODE> - cluster object.<DD><CODE>randomSwapAttempts</CODE> - See RebalanceCLI.<DD><CODE>randomSwapSuccesses</CODE> - See RebalanceCLI.<DD><CODE>randomSwapZoneIds</CODE> - The set of zoneIds to consider. Each zone is done
        independently.<DD><CODE>storeDefs</CODE> - List of store definitions
<DT><B>Returns:</B><DD>updated cluster</DL>
</DD>
</DL>
<HR>

<A NAME="swapGreedyRandomPartitions(voldemort.cluster.Cluster, java.util.List, int, int, java.util.List)"><!-- --></A><H3>
swapGreedyRandomPartitions</H3>
<PRE>
public static <A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A> <B>swapGreedyRandomPartitions</B>(<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A>&nbsp;nextCandidateCluster,
                                                 java.util.List&lt;java.lang.Integer&gt;&nbsp;nodeIds,
                                                 int&nbsp;greedySwapMaxPartitionsPerNode,
                                                 int&nbsp;greedySwapMaxPartitionsPerZone,
                                                 java.util.List&lt;<A HREF="../../voldemort/store/StoreDefinition.html" title="class in voldemort.store">StoreDefinition</A>&gt;&nbsp;storeDefs)</PRE>
<DL>
<DD>For each node in specified zones, tries swapping some minimum number of
 random partitions per node with some minimum number of random partitions
 from other specified nodes. Chooses the best swap in each iteration.
 Large values of the greedSwapMaxPartitions... arguments make this method
 equivalent to comparing every possible swap. This may get very expensive.
 
 So if a node had partitions P1, P2, P3 and P4 and the other partitions
 set was Q1, Q2, Q3, Q4, Q5 The combinations that will be tried for
 swapping will be the cartesian product of the two sets. That is, {P1,
 Q1}, {P2, Q2}...{P2,Q1}, {P2,Q2}, in total 20 such swap pairs will be
 generated. The best among these swap pairs will be chosen.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>nextCandidateCluster</CODE> - <DD><CODE>nodeIds</CODE> - Node IDs within which to shuffle partitions<DD><CODE>greedySwapMaxPartitionsPerNode</CODE> - See RebalanceCLI.<DD><CODE>greedySwapMaxPartitionsPerZone</CODE> - See RebalanceCLI.<DD><CODE>storeDefs</CODE> - 
<DT><B>Returns:</B><DD>updated cluster</DL>
</DD>
</DL>
<HR>

<A NAME="greedyShufflePartitions(voldemort.cluster.Cluster, int, int, int, java.util.List, java.util.List)"><!-- --></A><H3>
greedyShufflePartitions</H3>
<PRE>
public static <A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A> <B>greedyShufflePartitions</B>(<A HREF="../../voldemort/cluster/Cluster.html" title="class in voldemort.cluster">Cluster</A>&nbsp;nextCandidateCluster,
                                              int&nbsp;greedyAttempts,
                                              int&nbsp;greedySwapMaxPartitionsPerNode,
                                              int&nbsp;greedySwapMaxPartitionsPerZone,
                                              java.util.List&lt;java.lang.Integer&gt;&nbsp;greedySwapZoneIds,
                                              java.util.List&lt;<A HREF="../../voldemort/store/StoreDefinition.html" title="class in voldemort.store">StoreDefinition</A>&gt;&nbsp;storeDefs)</PRE>
<DL>
<DD>Within a single zone, tries swapping some minimum number of random
 partitions per node with some minimum number of random partitions from
 other nodes within the zone. Chooses the best swap in each iteration.
 Large values of the greedSwapMaxPartitions... arguments make this method
 equivalent to comparing every possible swap. This is very expensive.
 
 Normal case should be :
 
 #zones X #nodes/zone X max partitions/node X max partitions/zone
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>nextCandidateCluster</CODE> - cluster object.<DD><CODE>greedyAttempts</CODE> - See RebalanceCLI.<DD><CODE>greedySwapMaxPartitionsPerNode</CODE> - See RebalanceCLI.<DD><CODE>greedySwapMaxPartitionsPerZone</CODE> - See RebalanceCLI.<DD><CODE>greedySwapZoneIds</CODE> - The set of zoneIds to consider. Each zone is done
        independently.<DD><CODE>storeDefs</CODE> - 
<DT><B>Returns:</B><DD>updated cluster</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/Repartitioner.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../voldemort/tools/RebalancePlanCLI.html" title="class in voldemort.tools"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../voldemort/tools/RepartitionerCLI.html" title="class in voldemort.tools"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html?voldemort/tools/Repartitioner.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="Repartitioner.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
Jay Kreps, Roshan Sumbaly, Alex Feinberg, Bhupesh Bansal, Lei Gao, Chinmay Soman, Vinoth Chandar, Zhongjie Wu
</BODY>
</HTML>
