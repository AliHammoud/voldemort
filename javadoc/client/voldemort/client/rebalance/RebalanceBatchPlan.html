<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_27) on Thu Aug 08 14:55:55 PDT 2013 -->
<TITLE>
RebalanceBatchPlan (Voldemort)
</TITLE>

<META NAME="date" CONTENT="2013-08-08">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="RebalanceBatchPlan (Voldemort)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/RebalanceBatchPlan.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV CLASS&nbsp;
&nbsp;<A HREF="../../../voldemort/client/rebalance/RebalanceBatchPlanProgressBar.html" title="class in voldemort.client.rebalance"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?voldemort/client/rebalance/RebalanceBatchPlan.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="RebalanceBatchPlan.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
voldemort.client.rebalance</FONT>
<BR>
Class RebalanceBatchPlan</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>voldemort.client.rebalance.RebalanceBatchPlan</B>
</PRE>
<HR>
<DL>
<DT><PRE>public class <B>RebalanceBatchPlan</B><DT>extends java.lang.Object</DL>
</PRE>

<P>
Constructs a batch plan that goes from currentCluster to finalCluster. The
 partition-stores included in the move are based on those listed in storeDefs.
 This batch plan is execution-agnostic, i.e., a plan is generated and later
 stealer- versus donor-based execution of that plan is decided.
 
 Long term, its unclear if the notion of RebalanceBatchPlan separate from
 RebalancePlan is needed. Batching tends to increase the overall cost of
 rebalancing and has historically been error prone. (I.e., the transition
 between batches has had intermittent failures.) Its value, if any, lies in
 allowing long-running (days or weeks) rebalancing jobs to have interim
 checkpoints such that single node failures don't force a restart from initial
 state. Should consider deprecating batching after zone expansion and zone
 shrinking have been done successfully as short (less than a day or two),
 single-batch rebalances.
<P>

<P>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;java.util.List&lt;<A HREF="../../../voldemort/client/rebalance/RebalanceTaskInfo.html" title="class in voldemort.client.rebalance">RebalanceTaskInfo</A>&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../voldemort/client/rebalance/RebalanceBatchPlan.html#batchPlan">batchPlan</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../voldemort/client/rebalance/RebalanceBatchPlan.html#RebalanceBatchPlan(voldemort.cluster.Cluster, voldemort.cluster.Cluster, java.util.List)">RebalanceBatchPlan</A></B>(voldemort.cluster.Cluster&nbsp;currentCluster,
                   voldemort.cluster.Cluster&nbsp;finalCluster,
                   java.util.List&lt;voldemort.store.StoreDefinition&gt;&nbsp;commonStoreDefs)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Develops a batch plan to go from current cluster to final cluster for
 given stores.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../voldemort/client/rebalance/RebalanceBatchPlan.html#RebalanceBatchPlan(voldemort.cluster.Cluster, java.util.List, voldemort.cluster.Cluster, java.util.List)">RebalanceBatchPlan</A></B>(voldemort.cluster.Cluster&nbsp;currentCluster,
                   java.util.List&lt;voldemort.store.StoreDefinition&gt;&nbsp;currentStoreDefs,
                   voldemort.cluster.Cluster&nbsp;finalCluster,
                   java.util.List&lt;voldemort.store.StoreDefinition&gt;&nbsp;finalStoreDefs)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Develops a batch plan to go from current cluster/stores to final
 cluster/stores.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.util.List&lt;<A HREF="../../../voldemort/client/rebalance/RebalanceTaskInfo.html" title="class in voldemort.client.rebalance">RebalanceTaskInfo</A>&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../voldemort/client/rebalance/RebalanceBatchPlan.html#getBatchPlan()">getBatchPlan</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../voldemort/client/rebalance/RebalanceBatchPlan.html#getCrossZonePartitionStoreMoves()">getCrossZonePartitionStoreMoves</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Determines total number of partition-stores moved across zones.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;voldemort.cluster.Cluster</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../voldemort/client/rebalance/RebalanceBatchPlan.html#getCurrentCluster()">getCurrentCluster</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.util.List&lt;voldemort.store.StoreDefinition&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../voldemort/client/rebalance/RebalanceBatchPlan.html#getCurrentStoreDefs()">getCurrentStoreDefs</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../voldemort/client/rebalance/RebalanceBatchPlan.html#getDonorId(voldemort.routing.StoreRoutingPlan, voldemort.routing.StoreRoutingPlan, int, int, int)">getDonorId</A></B>(voldemort.routing.StoreRoutingPlan&nbsp;currentSRP,
           voldemort.routing.StoreRoutingPlan&nbsp;finalSRP,
           int&nbsp;stealerZoneId,
           int&nbsp;stealerNodeId,
           int&nbsp;stealerPartitionId)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decide which donor node to steal from.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;voldemort.cluster.Cluster</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../voldemort/client/rebalance/RebalanceBatchPlan.html#getFinalCluster()">getFinalCluster</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.util.List&lt;voldemort.store.StoreDefinition&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../voldemort/client/rebalance/RebalanceBatchPlan.html#getFinalStoreDefs()">getFinalStoreDefs</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;voldemort.utils.MoveMap</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../voldemort/client/rebalance/RebalanceBatchPlan.html#getNodeMoveMap()">getNodeMoveMap</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../voldemort/client/rebalance/RebalanceBatchPlan.html#getPartitionStoreMoves()">getPartitionStoreMoves</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return the total number of partition-store moves</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../voldemort/client/rebalance/RebalanceBatchPlanProgressBar.html" title="class in voldemort.client.rebalance">RebalanceBatchPlanProgressBar</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../voldemort/client/rebalance/RebalanceBatchPlan.html#getProgressBar(int)">getProgressBar</A></B>(int&nbsp;batchId)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../voldemort/client/rebalance/RebalanceBatchPlan.html#getTaskCount()">getTaskCount</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the number of rebalance tasks in this batch.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;voldemort.utils.MoveMap</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../voldemort/client/rebalance/RebalanceBatchPlan.html#getZoneMoveMap()">getZoneMoveMap</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../voldemort/client/rebalance/RebalanceBatchPlan.html#toString()">toString</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="batchPlan"><!-- --></A><H3>
batchPlan</H3>
<PRE>
protected final java.util.List&lt;<A HREF="../../../voldemort/client/rebalance/RebalanceTaskInfo.html" title="class in voldemort.client.rebalance">RebalanceTaskInfo</A>&gt; <B>batchPlan</B></PRE>
<DL>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="RebalanceBatchPlan(voldemort.cluster.Cluster, java.util.List, voldemort.cluster.Cluster, java.util.List)"><!-- --></A><H3>
RebalanceBatchPlan</H3>
<PRE>
public <B>RebalanceBatchPlan</B>(voldemort.cluster.Cluster&nbsp;currentCluster,
                          java.util.List&lt;voldemort.store.StoreDefinition&gt;&nbsp;currentStoreDefs,
                          voldemort.cluster.Cluster&nbsp;finalCluster,
                          java.util.List&lt;voldemort.store.StoreDefinition&gt;&nbsp;finalStoreDefs)</PRE>
<DL>
<DD>Develops a batch plan to go from current cluster/stores to final
 cluster/stores.
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>currentCluster</CODE> - <DD><CODE>currentStoreDefs</CODE> - <DD><CODE>finalCluster</CODE> - <DD><CODE>finalStoreDefs</CODE> - </DL>
</DL>
<HR>

<A NAME="RebalanceBatchPlan(voldemort.cluster.Cluster, voldemort.cluster.Cluster, java.util.List)"><!-- --></A><H3>
RebalanceBatchPlan</H3>
<PRE>
public <B>RebalanceBatchPlan</B>(voldemort.cluster.Cluster&nbsp;currentCluster,
                          voldemort.cluster.Cluster&nbsp;finalCluster,
                          java.util.List&lt;voldemort.store.StoreDefinition&gt;&nbsp;commonStoreDefs)</PRE>
<DL>
<DD>Develops a batch plan to go from current cluster to final cluster for
 given stores. (Stores is common for current and final cluster.)
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>currentCluster</CODE> - <DD><CODE>finalCluster</CODE> - <DD><CODE>commonStoreDefs</CODE> - </DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="getCurrentCluster()"><!-- --></A><H3>
getCurrentCluster</H3>
<PRE>
public voldemort.cluster.Cluster <B>getCurrentCluster</B>()</PRE>
<DL>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getCurrentStoreDefs()"><!-- --></A><H3>
getCurrentStoreDefs</H3>
<PRE>
public java.util.List&lt;voldemort.store.StoreDefinition&gt; <B>getCurrentStoreDefs</B>()</PRE>
<DL>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getFinalCluster()"><!-- --></A><H3>
getFinalCluster</H3>
<PRE>
public voldemort.cluster.Cluster <B>getFinalCluster</B>()</PRE>
<DL>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getFinalStoreDefs()"><!-- --></A><H3>
getFinalStoreDefs</H3>
<PRE>
public java.util.List&lt;voldemort.store.StoreDefinition&gt; <B>getFinalStoreDefs</B>()</PRE>
<DL>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getBatchPlan()"><!-- --></A><H3>
getBatchPlan</H3>
<PRE>
public java.util.List&lt;<A HREF="../../../voldemort/client/rebalance/RebalanceTaskInfo.html" title="class in voldemort.client.rebalance">RebalanceTaskInfo</A>&gt; <B>getBatchPlan</B>()</PRE>
<DL>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getProgressBar(int)"><!-- --></A><H3>
getProgressBar</H3>
<PRE>
public <A HREF="../../../voldemort/client/rebalance/RebalanceBatchPlanProgressBar.html" title="class in voldemort.client.rebalance">RebalanceBatchPlanProgressBar</A> <B>getProgressBar</B>(int&nbsp;batchId)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getZoneMoveMap()"><!-- --></A><H3>
getZoneMoveMap</H3>
<PRE>
public voldemort.utils.MoveMap <B>getZoneMoveMap</B>()</PRE>
<DL>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getNodeMoveMap()"><!-- --></A><H3>
getNodeMoveMap</H3>
<PRE>
public voldemort.utils.MoveMap <B>getNodeMoveMap</B>()</PRE>
<DL>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getCrossZonePartitionStoreMoves()"><!-- --></A><H3>
getCrossZonePartitionStoreMoves</H3>
<PRE>
public int <B>getCrossZonePartitionStoreMoves</B>()</PRE>
<DL>
<DD>Determines total number of partition-stores moved across zones.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>number of cross zone partition-store moves</DL>
</DD>
</DL>
<HR>

<A NAME="getPartitionStoreMoves()"><!-- --></A><H3>
getPartitionStoreMoves</H3>
<PRE>
public int <B>getPartitionStoreMoves</B>()</PRE>
<DL>
<DD>Return the total number of partition-store moves
<P>
<DD><DL>

<DT><B>Returns:</B><DD>Number of moves</DL>
</DD>
</DL>
<HR>

<A NAME="getTaskCount()"><!-- --></A><H3>
getTaskCount</H3>
<PRE>
public int <B>getTaskCount</B>()</PRE>
<DL>
<DD>Returns the number of rebalance tasks in this batch.
<P>
<DD><DL>

<DT><B>Returns:</B><DD>number of rebalance tasks in this batch</DL>
</DD>
</DL>
<HR>

<A NAME="getDonorId(voldemort.routing.StoreRoutingPlan, voldemort.routing.StoreRoutingPlan, int, int, int)"><!-- --></A><H3>
getDonorId</H3>
<PRE>
protected int <B>getDonorId</B>(voldemort.routing.StoreRoutingPlan&nbsp;currentSRP,
                         voldemort.routing.StoreRoutingPlan&nbsp;finalSRP,
                         int&nbsp;stealerZoneId,
                         int&nbsp;stealerNodeId,
                         int&nbsp;stealerPartitionId)</PRE>
<DL>
<DD>Decide which donor node to steal from. This is a policy implementation.
 I.e., in the future, additional policies could be considered. At that
 time, this method should be overridden in a sub-class, or a policy object
 ought to implement this algorithm.
 
 Current policy:
 
 1) If possible, a stealer node that is the zone n-ary in the finalCluster
 steals from the zone n-ary in the currentCluster in the same zone.
 
 2) If there are no partition-stores to steal in the same zone (i.e., this
 is the "zone expansion" use case), then a differnt policy must be used.
 The stealer node that is the zone n-ary in the finalCluster determines
 which pre-existing zone in the currentCluster hosts the primary partition
 id for the partition-store. The stealer then steals the zone n-ary from
 that pre-existing zone.
 
 This policy avoids unnecessary cross-zone moves and distributes the load
 of cross-zone moves approximately-uniformly across pre-existing zones.
 
 Other policies to consider:
 
 - For zone expansion, steal all partition-stores from one specific
 pre-existing zone.
 
 - Replace heuristic to approximately uniformly distribute load among
 existing zones to something more concrete (i.e. track steals from each
 pre-existing zone and forcibly balance them).
 
 - Select a single donor for all replicas in a new zone. This will require
 donor-based rebalancing to be run (at least for this specific part of the
 plan). This would reduce the number of donor-side scans of data. (But
 still send replication factor copies over the WAN.) This would require
 apparatus in the RebalanceController to work.
 
 - Set up some sort of chain-replication in which a single stealer in the
 new zone steals some replica from a pre-exising zone, and then other
 n-aries in the new zone steal from the single cross-zone stealer in the
 zone. This would require apparatus in the RebalanceController to work.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>currentSRP</CODE> - <DD><CODE>finalSRP</CODE> - <DD><CODE>stealerZoneId</CODE> - <DD><CODE>stealerNodeId</CODE> - <DD><CODE>stealerPartitionId</CODE> - 
<DT><B>Returns:</B><DD>the node id of the donor for this partition Id.</DL>
</DD>
</DL>
<HR>

<A NAME="toString()"><!-- --></A><H3>
toString</H3>
<PRE>
public java.lang.String <B>toString</B>()</PRE>
<DL>
<DD><DL>
<DT><B>Overrides:</B><DD><CODE>toString</CODE> in class <CODE>java.lang.Object</CODE></DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/RebalanceBatchPlan.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV CLASS&nbsp;
&nbsp;<A HREF="../../../voldemort/client/rebalance/RebalanceBatchPlanProgressBar.html" title="class in voldemort.client.rebalance"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?voldemort/client/rebalance/RebalanceBatchPlan.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="RebalanceBatchPlan.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
Jay Kreps, Roshan Sumbaly, Alex Feinberg, Bhupesh Bansal, Lei Gao, Chinmay Soman, Vinoth Chandar, Zhongjie Wu
</BODY>
</HTML>
